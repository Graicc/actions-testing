name: Publish Release
on:
  release:
    types: [published]

jobs:
  publish-release:
    name: Publish Release
    runs-on: ubuntu-latest
    steps:
      - name: Print GitHub context
        env:
          GITHUB_CONTEXT: ${{ toJson(github) }}
        run: echo "$GITHUB_CONTEXT"

      - uses: actions/checkout@v3
      - name: Send Webhook
        run: |
          curl https://raw.githubusercontent.com/ChaoticWeg/discord.sh/master/discord.sh -o discord.sh
          chmod +x ./discord.sh
          ./discord.sh \
          --webhook-url="${{ secrets.PUBLISH_WEBHOOK_URL }}" \
          --username "${{ github.event.release.author.login }}" \
          --avatar "${{ github.event.release.author.avatar_url }}" \
          --text "$(jq -Rs . <.github/templates/release.md | cut -c 2- | rev | cut -c 2- | rev)" 